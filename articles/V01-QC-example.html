<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Data/Normalization QC â€¢ cellhashR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Data/Normalization QC">
<meta property="og:description" content="cellhashR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cellhashR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/V01-QC-example.html">Data/Normalization QC</a>
    </li>
    <li>
      <a href="../articles/V02-BFF-example.html">Demultiplexing with Bimodal Flexible Fitting (BFF)</a>
    </li>
    <li>
      <a href="../articles/V03-Benchmark-example.html">Benchmarking Demultiplexing Algorithms with cellhashR</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/BimberLab/cellhashR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="V01-QC-example_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Data/Normalization QC</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/BimberLab/cellhashR/blob/master/vignettes/V01-QC-example.Rmd"><code>vignettes/V01-QC-example.Rmd</code></a></small>
      <div class="hidden name"><code>V01-QC-example.Rmd</code></div>

    </div>

    
    
<p>This vignette demonstrates the QC plots generated by cellhashR and loading of data directly from 10X Genomics files.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/BimberLab/cellhashR">cellhashR</a></span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>message<span class="op">=</span><span class="cn">FALSE</span>, warning<span class="op">=</span><span class="cn">FALSE</span>, echo<span class="op">=</span><span class="cn">TRUE</span>, error<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div id="data-loading-qc" class="section level1">
<h1 class="hasAnchor">
<a href="#data-loading-qc" class="anchor"></a>Data Loading / QC</h1>
<p>Data is loaded for analysis from the umi_count directory of 10X Genomics data using the cellhashR command ProcessCountMatrix. This function loads raw counts and performs basic filtering and QC. The input count matrix was generated to include all possible barcodes. The figures demonstrate that only MS-11 and MS-12 barcodes are present.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">citeSeqCountDir</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">saturation</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PlotLibrarySaturation.html">PlotLibrarySaturation</a></span><span class="op">(</span><span class="va">citeSeqCountDir</span>, metricsFile <span class="op">=</span> <span class="va">metricsFile</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">rawCountData</span> <span class="op">=</span> <span class="st">"../tests/testdata/438-21-GEX/umi_count"</span>
<span class="va">barcodeData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ProcessCountMatrix.html">ProcessCountMatrix</a></span><span class="op">(</span>rawCountData <span class="op">=</span> <span class="va">rawCountData</span>, minCountPerCell <span class="op">=</span> <span class="va">minCountPerCell</span>, barcodeWhitelist <span class="op">=</span> <span class="va">barcodeWhitelist</span>, saveOriginalCellBarcodeFile <span class="op">=</span> <span class="va">saveOriginalCellBarcodeFile</span>, metricsFile <span class="op">=</span> <span class="va">metricsFile</span><span class="op">)</span>
<span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">barcodeData</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">'No passing barcodes'</span><span class="op">)</span>
<span class="op">}</span>

<span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">barcodeData</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">'No passing cells'</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="QC-example_files/figure-html/QC-1.png" width="576"><img src="QC-example_files/figure-html/QC-2.png" width="576"><img src="QC-example_files/figure-html/QC-3.png" width="576"><img src="QC-example_files/figure-html/QC-4.png" width="576"><img src="QC-example_files/figure-html/QC-5.png" width="576"></p>
</div>
<div id="normalization-qc" class="section level1">
<h1 class="hasAnchor">
<a href="#normalization-qc" class="anchor"></a>Normalization / QC</h1>
<p>The plots below are generated using the cellhashR command PlotNormalizationQC and are designed to provide visualization of potential normalizations.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/PlotNormalizationQC.html">PlotNormalizationQC</a></span><span class="op">(</span><span class="va">barcodeData</span><span class="op">)</span></code></pre></div>
<p><img src="QC-example_files/figure-html/NormalizationQC-1.png" width="576"><img src="QC-example_files/figure-html/NormalizationQC-2.png" width="576"><img src="QC-example_files/figure-html/NormalizationQC-3.png" width="576"><img src="QC-example_files/figure-html/NormalizationQC-4.png" width="576"><img src="QC-example_files/figure-html/NormalizationQC-5.png" width="576"><img src="QC-example_files/figure-html/NormalizationQC-6.png" width="576"><img src="QC-example_files/figure-html/NormalizationQC-7.png" width="576"><img src="QC-example_files/figure-html/NormalizationQC-8.png" width="576"></p>
<div id="bimodal-quantile-normalization-bqn" class="section level2">
<h2 class="hasAnchor">
<a href="#bimodal-quantile-normalization-bqn" class="anchor"></a>Bimodal Quantile Normalization (BQN)</h2>
<p><img src="QC-example_files/figure-html/NormalizationQC-9.png" width="576"><img src="QC-example_files/figure-html/NormalizationQC-10.png" width="576"><img src="QC-example_files/figure-html/NormalizationQC-11.png" width="576"><img src="QC-example_files/figure-html/NormalizationQC-12.png" width="576"></p>
</div>
<div id="quantile-normalization" class="section level2">
<h2 class="hasAnchor">
<a href="#quantile-normalization" class="anchor"></a>Quantile Normalization</h2>
<p><img src="QC-example_files/figure-html/NormalizationQC-13.png" width="576"><img src="QC-example_files/figure-html/NormalizationQC-14.png" width="576"><img src="QC-example_files/figure-html/NormalizationQC-15.png" width="576"><img src="QC-example_files/figure-html/NormalizationQC-16.png" width="576"></p>
</div>
<div id="log2center-normalization" class="section level2">
<h2 class="hasAnchor">
<a href="#log2center-normalization" class="anchor"></a>Log2Center Normalization</h2>
<p><img src="QC-example_files/figure-html/NormalizationQC-17.png" width="576"><img src="QC-example_files/figure-html/NormalizationQC-18.png" width="576"><img src="QC-example_files/figure-html/NormalizationQC-19.png" width="576"><img src="QC-example_files/figure-html/NormalizationQC-20.png" width="576"></p>
</div>
<div id="clr-normalization" class="section level2">
<h2 class="hasAnchor">
<a href="#clr-normalization" class="anchor"></a>CLR Normalization</h2>
<p><img src="QC-example_files/figure-html/NormalizationQC-21.png" width="576"><img src="QC-example_files/figure-html/NormalizationQC-22.png" width="576"><img src="QC-example_files/figure-html/NormalizationQC-23.png" width="576"><img src="QC-example_files/figure-html/NormalizationQC-24.png" width="576"></p>
</div>
</div>
<div id="next-steps" class="section level1">
<h1 class="hasAnchor">
<a href="#next-steps" class="anchor"></a>Next Steps</h1>
<p>The next step is performing classification, which is demonstrated in the Benchmark example vignette. Details on classification using Bimodal Flexible Fitting (BFF) are provided in the BFF vignette.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
