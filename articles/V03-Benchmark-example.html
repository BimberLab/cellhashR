<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Benchmarking Demultiplexing Algorithms with cellhashR • cellhashR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Benchmarking Demultiplexing Algorithms with cellhashR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cellhashR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/V01-QC-example.html">Data/Normalization QC</a>
    </li>
    <li>
      <a href="../articles/V02-BFF-example.html">Demultiplexing with Bimodal Flexible Fitting (BFF)</a>
    </li>
    <li>
      <a href="../articles/V03-Benchmark-example.html">Benchmarking Demultiplexing Algorithms with cellhashR</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/BimberLab/cellhashR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Benchmarking Demultiplexing Algorithms with
cellhashR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/BimberLab/cellhashR/blob/master/vignettes/V03-Benchmark-example.Rmd" class="external-link"><code>vignettes/V03-Benchmark-example.Rmd</code></a></small>
      <div class="hidden name"><code>V03-Benchmark-example.Rmd</code></div>

    </div>

    
    
<p>This vignette demonstrates how to use cellhashR to easily run
multiple demultiplexing algorithms on cell hashing data in order to
produce the type of classifications summarized in this figure from the
BFF paper.</p>
<p><img src="Benchmark-example_files%2Ffigure-html%2FBenchmark_fig.png" width="525"></p>
<div class="section level2">
<h2 id="load-data">Load Data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h2>
<p>cellhashR expects count data with cells in columns and barcode
features in rows.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/BimberLab/cellhashR" class="external-link">cellhashR</a></span><span class="op">)</span></span>
<span><span class="va">rawCountData</span> <span class="op">&lt;-</span> <span class="st">"../tests/testdata/MS/cell_type_counts.csv"</span></span>
<span><span class="va">barcodeData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">rawCountData</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="generate-hashing-calls">Generate Hashing Calls<a class="anchor" aria-label="anchor" href="#generate-hashing-calls"></a>
</h2>
<p>The cellhashR command GenerateCellHashingCalls performs
demultiplexing analysis on the data using the algorithms listed in
“methods”. The plots that follow are the most informative of the plots
generated by each demultiplexing algorithm.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">methods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bff_cluster"</span>, <span class="st">"bff_raw"</span>, <span class="st">"gmm_demux"</span>, <span class="st">"multiseq"</span>, <span class="st">"htodemux"</span>, <span class="st">"dropletutils"</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GenerateCellHashingCalls.html">GenerateCellHashingCalls</a></span><span class="op">(</span>barcodeMatrix <span class="op">=</span> <span class="va">barcodeData</span>, methods <span class="op">=</span> <span class="va">methods</span>, cellbarcodeWhitelist <span class="op">=</span> <span class="va">cellbarcodeWhitelist</span>, metricsFile <span class="op">=</span> <span class="va">metricsFile</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.table</a></span><span class="op">(</span><span class="va">df</span>, file <span class="op">=</span> <span class="va">callFile</span>, sep <span class="op">=</span> <span class="st">'\t'</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>, quote <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="bff_cluster">BFF_cluster<a class="anchor" aria-label="anchor" href="#bff_cluster"></a>
</h3>
<p><img src="Benchmark-example_files%2Ffigure-html%2FGenerateCalls-1.png" width="576"><img src="Benchmark-example_files%2Ffigure-html%2FGenerateCalls-2.png" width="576"><img src="Benchmark-example_files%2Ffigure-html%2FGenerateCalls-3.png" width="576"><img src="Benchmark-example_files%2Ffigure-html%2FGenerateCalls-4.png" width="576"><img src="Benchmark-example_files%2Ffigure-html%2FGenerateCalls-17.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="bff_threshold">BFF_threshold<a class="anchor" aria-label="anchor" href="#bff_threshold"></a>
</h3>
<p><img src="Benchmark-example_files%2Ffigure-html%2FGenerateCalls-19.png" width="576"><img src="Benchmark-example_files%2Ffigure-html%2FGenerateCalls-20.png" width="576"><img src="Benchmark-example_files%2Ffigure-html%2FGenerateCalls-33.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="gmm-demux">GMM Demux<a class="anchor" aria-label="anchor" href="#gmm-demux"></a>
</h3>
<p><img src="Benchmark-example_files%2Ffigure-html%2FGenerateCalls-35.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="multi-seq">MULTI-Seq<a class="anchor" aria-label="anchor" href="#multi-seq"></a>
</h3>
<p><img src="Benchmark-example_files%2Ffigure-html%2FGenerateCalls-48.png" width="576"><img src="Benchmark-example_files%2Ffigure-html%2FGenerateCalls-49.png" width="576"><img src="Benchmark-example_files%2Ffigure-html%2FGenerateCalls-50.png" width="576"><img src="Benchmark-example_files%2Ffigure-html%2FGenerateCalls-51.png" width="576"><img src="Benchmark-example_files%2Ffigure-html%2FGenerateCalls-64.png" width="576"><img src="Benchmark-example_files%2Ffigure-html%2FGenerateCalls-65.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="seurat-htodemux">Seurat HTODemux<a class="anchor" aria-label="anchor" href="#seurat-htodemux"></a>
</h3>
<p><img src="Benchmark-example_files%2Ffigure-html%2FGenerateCalls-66.png" width="576"><img src="Benchmark-example_files%2Ffigure-html%2FGenerateCalls-79.png" width="576"><img src="Benchmark-example_files%2Ffigure-html%2FGenerateCalls-80.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="dropletutils-hasheddrops">DropletUtils hashedDrops<a class="anchor" aria-label="anchor" href="#dropletutils-hasheddrops"></a>
</h3>
<p><img src="Benchmark-example_files%2Ffigure-html%2FGenerateCalls-81.png" width="576"><img src="Benchmark-example_files%2Ffigure-html%2FGenerateCalls-82.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="summary-of-calls">Summary of Calls<a class="anchor" aria-label="anchor" href="#summary-of-calls"></a>
</h3>
<p>After all of the demultiplexing algorithms have run, the
classifications are summarized as in these plots.</p>
<p><img src="Benchmark-example_files%2Ffigure-html%2FGenerateCalls-95.png" width="576"></p>
<p>The classification summary above is related to the classification
summary in the BFF paper (shown again below) because the HEK sample is
composed of Bar1 and Bar2 droplets, the MEF sample is composed of Bar3
and Bar4 droplets, and the Jurkats sample is composed of droplets
assigned to the remaining barcodes.</p>
<p><img src="Benchmark-example_files%2Ffigure-html%2FBenchmark_fig.png" width="525"></p>
</div>
</div>
<div class="section level2">
<h2 id="calls-per-cell">Calls Per Cell<a class="anchor" aria-label="anchor" href="#calls-per-cell"></a>
</h2>
<p>The output is a data frame, with the calls from each caller, and a
consensus call. See AppendCellHashing to append the results to a seurat
object as metadata.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Benchmark-example_files%2Ffigure-html%2FFinalCalls-1.png" width="496"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
